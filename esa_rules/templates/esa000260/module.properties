# Module Definition Properties
module_name=Email with OneNote File Attachment
module_desc=Detects when an attachment includes a OneNote file.
module_desc_long=Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon User Execution to gain execution.\r\n\r\nAdversaries may specifically use OneNote files for the delivery of the malware since the method does not involve macros and is easy to create, which can lead to a higher chance of a successful compromise.\r\n\r\nThis rule detects when an attachment includes a OneNote file.\r\n\r\nIMPORTANT: The below can be a breaking change if you have other ESA rules that do not expect the "filename" meta key to be an array. Make sure to update other ESA rules you may have that do not consider "filename" as an array.\r\n\r\nFor better accuracy, you can change the Meta Key Type for "filename" from "string" to String[]":\r\n1. Go to Admin > Services ESA Correlation > Explore\r\n2. Click on correlation > stream\r\n3. Under "multi-valued" add ',filename' to the end of the list\r\n4. Navigate to Config > ESA Rules > Settings > Meta Key References\r\n5. Click on the red "Re-Sync" button (circular arrows)\r\n6- Verify that "filename" now shows as type "string[]"